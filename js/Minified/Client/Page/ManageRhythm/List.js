"object"!=typeof BabblingBrook.Client.Page.ManageRhythm&&(BabblingBrook.Client.Page.ManageRhythm={}),BabblingBrook.Client.Page.ManageRhythm.List=function(){"use strict";var e=function(e,r,a,n){if(n.success===!1)t(n.error);else{r.removeClass("row-loading");var s=jQuery("img.publish",r),i=jQuery("img.delete",r),u=jQuery("img.deprecate",r);switch(n.deletable===!0?i.removeClass("hidden"):i.addClass("hidden"),e){case"publish":s.addClass("hidden"),i.addClass("hidden"),u.removeClass("hidden"),jQuery(".status",r).text("public");break;case"deprecate":s.removeClass("hidden"),u.addClass("hidden"),jQuery(".status",r).text("deprecated");break;case"delete":r.slideUp()}}},t=function(e){throw e},r=function(r,a,n){a.addClass("row-loading");var s="/"+n.username+"/rhythm/"+n.name+"/"+n.version+"/changestatus";BabblingBrook.Library.post(s,{action:r},e.bind(null,r,a,n),t.bind(null,"Error requesting status change for "+s))},a=function(){var e=jQuery("#rhythm_list_publish_button_template").html(),t=jQuery("#rhythm_list_delete_button_template").html(),a=jQuery("#rhythm_list_deprecate_button_template").html(),n=[{name:e,"class":"publish",onClick:function(e,t,a){e.preventDefault();var n=jQuery.trim(t.find(".status").text());if("private"===n&&jQuery("img.deprecate",t).hasClass("hidden")===!0){var s="Are you sure? You will not be able to edit or delete the rhythm once it has been published (You will be able to edit your rhythm by creating a new version.)";if(!confirm(s))return}r("publish",t,a)},onReady:function(e,t){"public"===t.status&&jQuery("img.publish",e).addClass("hidden")}},{name:t,"class":"delete",onClick:function(e,t,a){e.preventDefault();var n=jQuery("#rhythm_list_delete_button_confirm_template").html();confirm(n)===!0&&r("delete",t,a)},onReady:function(e,t){"private"===t.status&&jQuery("img.delete",e).removeClass("hidden")}},{name:a,"class":"deprecate",onClick:function(e,t,a){e.preventDefault(),r("deprecate",t,a)},onReady:function(e,t){"public"!==t.status&&jQuery("img.deprecate",e).addClass("hidden")}}],s=jQuery("#users_rhythm_search_container").attr("data-users-username"),i=jQuery("#users_rhythm_search_container").attr("data-users-domain");(s!==BabblingBrook.Client.User.username||i!==BabblingBrook.Client.User.domain)&&(n=[]);{var u={show_fields:{domain:!1,date_created:!0,status:!0,rhythm_category:!0,username:!1},initial_values:{domain:jQuery("#users_rhythm_search_container").attr("data-users-domain"),username:jQuery("#users_rhythm_search_container").attr("data-users-username")},exact_match:{domain:!0,username:!0},onReady:function(){var e=jQuery("#users_rhythm_search_container>table>tbody>tr");jQuery.each(e,function(e,t){var r=jQuery(t),a=jQuery("#users_rhythm_search_container").attr("data-users-username"),n=jQuery(".name",r).text(),s=jQuery(".version",r).text(),i="/"+a+"/rhythm/"+n+"/"+s+"/view",u=jQuery("<a>");u.attr("href",i).text(n),jQuery(".name",r).html(u)})}};new BabblingBrook.Client.Component.Selector("rhythm","users_rhythm_search",jQuery("#users_rhythm_search_container"),n,u)}};return{construct:function(){a(),"/sky"!==window.location.pathname.substring(0,4)&&BabblingBrook.Client.Core.Loaded.setRhythmListLoaded()}}}(),jQuery(function(){"use strict";BabblingBrook.Client.Page.ManageRhythm.List.construct()});
//# sourceMappingURL=/js/Minified/Client/Page/ManageRhythm/List.js.map