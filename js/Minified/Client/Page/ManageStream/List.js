"object"!=typeof BabblingBrook.Client.Page.ManageStream&&(BabblingBrook.Client.Page.ManageStream={}),BabblingBrook.Client.Page.ManageStream.List=function(){"use strict";var e=function(e,a,r,s){if(s.success===!1)t(s.error);else{a.removeClass("row-loading");var n=jQuery("img.publish",a),i=jQuery("img.delete",a),u=jQuery("img.deprecate",a),l=jQuery("img.revert",a);switch(s.deletable===!0?(l.removeClass("hidden"),i.removeClass("hidden")):(l.addClass("hidden"),i.addClass("hidden")),e){case"publish":n.addClass("hidden"),u.removeClass("hidden"),jQuery(".status",a).text("public");break;case"deprecate":n.removeClass("hidden"),u.addClass("hidden"),jQuery(".status",a).text("deprecated");break;case"revert":n.removeClass("hidden"),l.addClass("hidden"),u.addClass("hidden"),jQuery(".status",a).text("private");break;case"delete":a.slideUp()}}},t=function(e){throw e},a=function(e){throw e},r=function(a,r,s){r.addClass("row-loading");var n="/"+s.username+"/stream/"+s.name+"/"+s.version+"/changestatus";BabblingBrook.Library.post(n,{action:a},e.bind(null,a,r,s),t.bind(null,"Error requesting status change for "+n))},s=function(){var e=jQuery("#stream_list_publish_button_template").html(),t=jQuery("#stream_list_delete_button_template").html(),s=jQuery("#stream_list_deprecate_button_template").html(),n=jQuery("#stream_list_revert_button_template").html(),i=[{name:n,"class":"revert",onClick:function(e,t,a){e.preventDefault(),r("revert",t,a)}},{name:e,onClick:function(e,t,a){e.preventDefault();var s=jQuery.trim(t.find(".status").text());if("private"===s){var n="Are you sure? You will not be able to edit the stream once a user has made a post in your stream editing the stream. (You will be able to edit your stream by creating a new version.)";if(!confirm(n))return}r("publish",t,a)},onReady:function(e,t){"public"===t.status&&jQuery("img.publish",e).addClass("hidden")}},{name:t,"class":"delete",onClick:function(e,t,a){e.preventDefault();var s=jQuery("#stream_list_delete_button_confirm_template").html();confirm(s)===!0&&r("delete",t,a)},onReady:function(e,t){if("private"===t.status)jQuery("img.delete",e).removeClass("hidden");else{var r="/"+t.username+"/stream/"+t.name+"/"+t.version+"/getdeletablestatus";BabblingBrook.Library.post(r,{},function(s){s.success===!1?a("Server failed to fetch deletable status of a stream : "+r):s.deletable===!0&&(jQuery("img.delete",e).removeClass("hidden"),"private"!==t.status&&jQuery("img.revert",e).removeClass("hidden"))},a.bind(null,"Error fetching deletable status for "+r))}}},{name:s,"class":"deprecate",onClick:function(e,t,a){e.preventDefault(),r("deprecate",t,a)},onReady:function(e,t){"public"!==t.status&&jQuery("img.deprecate",e).addClass("hidden")}}],u=jQuery("#users_stream_search_container").attr("data-users-username"),l=jQuery("#users_stream_search_container").attr("data-users-domain");(u!==BabblingBrook.Client.User.username||l!==BabblingBrook.Client.User.domain)&&(i=[]);{var o={show_fields:{domain:!1,date_created:!0,status:!0,stream_kind:!0,username:!1},initial_values:{domain:l,username:u},exact_match:{domain:!0,username:!0},onReady:function(){var e=jQuery("#users_stream_search_container>table>tbody>tr");jQuery.each(e,function(e,t){var a=jQuery(t),r=jQuery("#users_stream_search_container").attr("data-users-username"),s=jQuery(".name",a).text(),n=jQuery(".version",a).text(),i="/"+r+"/stream/"+s+"/"+n+"/view",u=jQuery("<a>");u.attr("href",i).text(s),jQuery(".name",a).html(u)})}};new BabblingBrook.Client.Component.Selector("stream","users_stream_search",jQuery("#users_stream_search_container"),i,o)}};return{construct:function(){s()}}}(),jQuery(function(){"use strict";BabblingBrook.Client.Page.ManageStream.List.construct()});
//# sourceMappingURL=/js/Minified/Client/Page/ManageStream/List.js.map