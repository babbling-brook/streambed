"object"!=typeof BabblingBrook.Client.Page.Ring&&(BabblingBrook.Client.Page.Ring={}),BabblingBrook.Client.Page.Ring.Admin=function(){"use strict";var e=function(e){jQuery.each(e,function(e,r){jQuery("#"+e+"_error").text(r).removeClass("hide")})},r=function(r){jQuery("#update_ring_submit").removeClass("button-loading"),jQuery("#create_ring_submit").removeClass("button-loading"),"undefined"!=typeof r.errors&&e(r.errors),jQuery.each(BabblingBrook.Client.User.Rings,function(e,i){return i.domain===window.location.hostname&&i.name===jQuery("#ring_name").val()?(BabblingBrook.Client.User.Rings[e]=r.updated_ring,!1):!0}),"admin_invitation"===r.updated_ring.member_type?jQuery("#ring_member_invite_menu").removeClass("hide"):jQuery("#ring_member_invite_menu").addClass("hide"),"invitation"===r.updated_ring.admin_type?(jQuery("#ring_admin_invite_menu").removeClass("hide"),jQuery("#ring_resign_menu").removeClass("hide")):(jQuery("#ring_admin_invite_menu").addClass("hide"),jQuery("#ring_resign_menu").addClass("hide"))},i=function(r){if(jQuery("#create_ring_submit").removeClass("button-loading"),"undefined"!=typeof r.errors)e(r.errors);else{jQuery("#update_ring_submit").removeClass("hide"),jQuery("#create_ring_submit").addClass("hide"),jQuery("#ring_name").attr("disabled","disabled");{var i=window.location.protocol,n=window.location.host,t=i+"//"+n+"/"+jQuery("#ring_name").val()+"/ring/update";jQuery("#update_title_template").text()}BabblingBrook.Client.User.Rings.push(r.new_ring),BabblingBrook.Client.Core.Ajaxurl.redirect(t)}},n=function(){jQuery("#invitations_loading").addClass("hide"),jQuery("#update_ring_submit").removeClass("button-loading"),jQuery("#create_ring_submit").removeClass("button-loading");var e=jQuery("#on_ring_update_server_error_template").text();BabblingBrook.Client.Component.Messages.addMessage({type:"error",message:e})},t=function(){var e={name:jQuery("#ring_name").val(),membership:jQuery("#membership_type").val(),membership_rhythm:jQuery("#membership_rhythm").val(),membership_super_ring:jQuery("#membership_super_ring").val(),admin_type:jQuery("#admin_type").val(),admin_super_ring:jQuery("#admin_super_ring").val(),ring_rhythm:jQuery("#ring_rhythm").val()};return e},s=function(){var e=t();jQuery("#update_ring_submit").addClass("button-loading"),jQuery(".error").addClass("hide"),BabblingBrook.Library.post("/"+jQuery("#ring_name").val()+"/ring/updatejson",e,r,n)},a=function(){var e=t();jQuery("#create_ring_submit").addClass("button-loading"),jQuery(".error").addClass("hide"),BabblingBrook.Library.post("/"+BabblingBrook.Client.User.username+"/ring/createjson",e,i,n)};return{construct:function(){jQuery("#update_ring_submit").click(s),jQuery("#create_ring_submit").click(a),jQuery("#membership_type").change(function(){jQuery("#membership_rhythm_textfield").addClass("hide"),jQuery("#membership_super_ring_textfield").addClass("hide"),jQuery("#membership_rhythm_search").text("search"),jQuery("#membership_super_ring_search").text("search");var e=jQuery("option:selected",this).val();jQuery("#membership_rhythm_textfield").addClass("hide").css("display",""),jQuery("#membership_super_ring_selector").addClass("hide").css("display",""),jQuery("#membership_rhythm_selector").addClass("hide").css("display",""),jQuery("#membership_super_ring_textfield").addClass("hide").css("display",""),"56"===e?jQuery("#membership_rhythm_textfield").removeClass("hide"):"57"===e&&jQuery("#membership_super_ring_textfield").removeClass("hide")}),"56"===jQuery("#membership_type option:selected").val()&&jQuery("#membership_rhythm_textfield").removeClass("hide"),"57"===jQuery("#membership_type option:selected").val()&&jQuery("#membership_super_ring_textfield").removeClass("hide");var e;jQuery("#admin_type").click(function(){e=jQuery(this).val()}).change(function(){var r=jQuery("option:selected",this).val(),i=!0;"60"===r&&(i=confirm("If you select an option here that locks you out then you will no longer be able to edit these options. Please confirm.")),jQuery("#admin_super_ring_textfield").addClass("hide"),jQuery("#admin_super_ring_selector").hide().addClass("hide"),jQuery("#admin_super_ring_search").text("search"),i===!1&&jQuery("#admin_type").val(e),"60"===r&&i===!0?jQuery("#admin_super_ring_textfield").removeClass("hide"):jQuery("#admin_super_ring_textfield").addClass("hide")}),"60"===jQuery("#admin_type option:selected").val()&&jQuery("#admin_super_ring_textfield").removeClass("hide");var r=jQuery("#membership_rhythm_selector");jQuery("#membership_rhythm_search").click(function(){var e=jQuery(this);if(r.is(":visible"))return r.slideUp(250,function(){e.text("search"),r.empty()}),!1;{var i=[{name:"Select",onClick:function(i,n,t){i.preventDefault();var s=BabblingBrook.Library.makeRhythmUrl({domain:t.domain,username:t.username,name:t.name,version:t.version});jQuery("#membership_rhythm").val(s),r.slideUp(250,function(){e.text("search"),r.empty()})}}];new BabblingBrook.Client.Component.Selector("rhythm","member_rhythm",r,i,{show_fields:{domain:!1},initial_values:{rhythm_category:"ring"}})}return e.text("close search"),r.slideDown(250).removeClass("hide"),!1});var i=jQuery("#ring_rhythm_selector");jQuery("#ring_rhythm_search").click(function(){var e=jQuery(this);if(i.is(":visible"))return i.slideUp(250,function(){e.text("search"),i.empty()}),!1;{var r=[{name:"Select",onClick:function(r,n,t){r.preventDefault();var s=BabblingBrook.Library.makeRhythmUrl({domain:t.domain,username:t.username,name:t.name,version:t.version});jQuery("#ring_rhythm").val(s),i.slideUp(250,function(){e.text("search"),i.empty()})}}];new BabblingBrook.Client.Component.Selector("rhythm","ring_rhythm",i,r,{show_fields:{domain:!1},initial_values:{rhythm_category:"ring"}})}return e.text("close search"),i.slideDown(250).removeClass("hide"),!1});var n=jQuery("#membership_super_ring_selector");jQuery("#membership_super_ring_search").click(function(){var e=jQuery(this);if(n.is(":visible"))return n.slideUp(250,function(){e.text("search"),n.empty()}),!1;{var r=[{name:"Select",onClick:function(r,i,t){r.preventDefault(),jQuery("#membership_super_ring").val(t.username),n.slideUp(250,function(){e.text("search"),n.empty()})}}];new BabblingBrook.Client.Component.Selector("user","member_ring_user",n,r,{user_type:"ring",show_fields:{domain:!1},initial_values:{domain:window.location.hostname},exact_match:{domain:!0}})}return e.text("close search"),n.slideDown(250).removeClass("hide"),!1});var t=jQuery("#admin_super_ring_selector");jQuery("#admin_super_ring_search").click(function(){var e=jQuery(this);if(t.is(":visible"))return t.slideUp(250,function(){e.text("search"),t.empty()}),!1;{var r=[{name:"Select",onClick:function(r,i,n){r.preventDefault(),jQuery("#admin_super_ring").val(n.username),t.slideUp(250,function(){e.text("search"),t.empty()})}}];new BabblingBrook.Client.Component.Selector("user","admin_ring_user",t,r,{user_type:"ring",show_fields:{domain:!1},initial_values:{domain:window.location.hostname},exact_match:{domain:!0}})}return e.text("close search"),t.slideDown(250).removeClass("hide"),!1}),BabblingBrook.Client.Core.Loaded.setRingAdminLoaded()}}}(),jQuery(function(){"use strict";BabblingBrook.Client.Page.Ring.Admin.construct()});
//# sourceMappingURL=/js/Minified/Client/Page/Ring/Admin.js.map